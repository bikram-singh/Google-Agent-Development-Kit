# ğŸ›¡ï¸ GCP Security Command Center Vulnerability Agent  

An AI Agent built with the **Google Agent Developer Kit (ADK)** to retrieve findings from **Google Cloud Security Command Center (SCC)**.  
It detects **vulnerabilities, misconfigurations, threats, and observations** across your GCP Organization and exports results in both **CSV** and **Excel** formats.  

---

## ğŸ“– Project Overview  

The **GCP SCC Vulnerability Agent** helps security teams by:  
- Connecting to Google Cloud using **Application Default Credentials (ADC)**.  
- Fetching findings from **SCC v2** API.  
- Categorizing issues by **severity, category, and resource type**.  
- Exporting results into **findings.csv** and **findings.xlsx** for reporting.  
- Displaying results either in **Web UI** (ADK web) or via **CLI** (adk run).  

---

## ğŸ“ Project Structure  

```bash
gcp_vulnerability_agent/
â”œâ”€â”€ agent.py                  # Main agent script
â”œâ”€â”€ .env                      # Environment variables
â”œâ”€â”€ requirements.txt          # Python dependencies
â”œâ”€â”€ findings.csv              # Auto-generated CSV output
â”œâ”€â”€ findings.xlsx             # Auto-generated Excel output
â””â”€â”€ README.md                 # Project documentation
```

---

## âœ… Prerequisites  

### ğŸ”§ Google Cloud Setup  
1. Enable the **Security Command Center API** in GCP Console.  
2. Grant the following **IAM roles**:  
   - `roles/securitycenter.findingsViewer`  
   - `roles/securitycenter.adminViewer` *(optional for broader access)*  
   - `roles/viewer` *(optional for multi-project visibility)*  
3. Retrieve your **Organization ID**:  
   ```bash
   gcloud organizations list
   ```  
4. Create a **Service Account Key** and store the JSON securely. *(ADC can also be used instead of JSON keys)*  

---

## ğŸš€ Setup Instructions  

1. **Clone the Repository**  
   ```bash
   git clone https://github.com/bikram-singh/Google-Agent-Development-Kit/tree/main/4_gcp_vulnerability_agent
   cd 4_gcp_vulnerability_agent
   ```

2. **Create `.env` File**  
   ```env
   ORGANIZATION_ID=742653001909
   GOOGLE_API_KEY=YOUR_API_KEY
   # GOOGLE_APPLICATION_CREDENTIALS=/full/path/to/your-service-account.json
   ```  
   âš ï¸ Replace with your actual values. If using ADC, run:  
   ```bash
   gcloud auth application-default login
   ```

3. **Install Dependencies**  
   ```bash
   python3 -m venv .venv
   source .venv/bin/activate   # On Windows: .venv\Scripts\activate
   pip install --upgrade pip
   pip install -r requirements.txt
   ```

4. **Run the Agent**  

   - **Option 1: Web Interface**  
     ```bash
     adk web
     ```  
     Access the UI at: [http://localhost:8080](http://localhost:8080)  

   - **Option 2: Command Line**  
     ```bash
     adk run
     ```

---

## âš™ï¸ Agent Functionality  

- Connects to **GCP via ADC**  
- Fetches findings such as:  
  - Category (e.g., `SQL_INJECTION`)  
  - Severity (`HIGH`, `MEDIUM`, etc.)  
  - Resource type, display name, full resource path  
- Exports results into:  
  - `findings.csv`  
  - `findings.xlsx`  
- Provides formatted output in **UI or terminal**  

---

## ğŸ“¦ Requirements  

```txt
google-cloud-securitycenter>=1.39.0
google-cloud-core>=2.3.2
google-auth
python-dotenv
google-adk
pandas
openpyxl
```

---

## ğŸ“ Notes  

- Ensure **SCC is enabled** at the organization level.  
- Assets must be actively reporting findings.  
- Output files are stored in the **project root**.  

---

## ğŸ›  Troubleshooting  

| Problem              | Solution                                                                 |
|----------------------|---------------------------------------------------------------------------|
| ğŸ”’ Permission Error  | Ensure `roles/securitycenter.findingsViewer` is granted                  |
| âŒ Empty Results     | Enable SCC and **asset discovery** for your organization                 |
| ğŸ“¦ Module Not Found  | Run `pip install -r requirements.txt` inside your virtual environment    |
| ğŸ”‘ Auth Errors       | Double-check `.env` values or run `gcloud auth application-default login` |

---

âœ¨ Now your **README.md** is GitHub-ready!  
